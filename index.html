
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>CurlCal â€¢ Workout Tracker + Calendar</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="dark" />
  <meta name="theme-color" content="#0b1220" />
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='128' height='128' viewBox='0 0 24 24'%3E%3Cpath fill='%23ffffff' d='M1 10h3V7h2v10H4v-3H1zm19 7h-2V7h2v3h3v4h-3zM8 17H6V7h2zm8 0h-2V7h2zM9 15V9h6v6z'/%3E%3C/svg%3E" />
  <link rel="manifest" href="manifest.json" />
  <link href="css/style.css" rel="stylesheet">
</head>
<body>
  <div class="container">
    <header class="app-header">
      <div class="brand">
        <div class="logo" aria-hidden="true">
          <svg viewBox="0 0 24 24" width="18" height="18" fill="#c4b5fd" role="img" aria-label="CurlCal">
            <path d="M1 10h3V7h2v10H4v-3H1zm19 7h-2V7h2v3h3v4h-3zM8 17H6V7h2zm8 0h-2V7h2zM9 15V9h6v6z"/>
          </svg>
        </div>
        <div class="title">CurlCal</div>
      </div>
      <div id="authSection">
        <button id="loginBtn" class="btn">Login with Google</button>
      </div>
    </header>

    <nav class="tabs" role="tablist" aria-label="Sections">
      <button class="tab-btn active" id="tab-library" role="tab" aria-controls="panel-library" aria-selected="true">Exercise Library</button>
      <button class="tab-btn" id="tab-workout" role="tab" aria-controls="panel-workout" aria-selected="false">Workout</button>
      <button class="tab-btn" id="tab-calendar" role="tab" aria-controls="panel-calendar" aria-selected="false">Calendar</button>
    </nav>

    <!-- Exercise Library -->
    <section class="panel active" id="panel-library" role="tabpanel" aria-labelledby="tab-library">
      <div class="filters">
        <div class="filter-chips">
          <div id="muscleChips" class="chips">
            <span class="chip active" data-muscle="All">All</span>
            <span class="chip" data-muscle="Chest">Chest</span>
            <span class="chip" data-muscle="Back">Back</span>
            <span class="chip" data-muscle="Legs">Legs</span>
            <span class="chip" data-muscle="Shoulders">Shoulders</span>
            <span class="chip" data-muscle="Arms">Arms</span>
            <span class="chip" data-muscle="Core">Core</span>
            <span class="chip" data-muscle="Full Body">Full Body</span>
            <span class="chip" data-muscle="Custom">Custom</span>
          </div>
        </div>
        <label class="search" title="Search workouts">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="#94a3b8" aria-hidden="true"><path d="M21 20l-5.7-5.7a7 7 0 10-1.4 1.4L20 21l1-1zM5 10a5 5 0 1110 0 5 5 0 01-10 0z"/></svg>
          <input id="searchInput" type="search" placeholder="Search workouts..." aria-label="Search workouts" />
        </label>
      </div>
      <div id="libraryGrid" class="grid" aria-live="polite"></div>
    </section>

    <!-- Workout -->
    <section class="panel" id="panel-workout" role="tabpanel" aria-labelledby="tab-workout">
      <div id="workoutContent">
        <div class="workout-empty">
          <div>
            <div style="font-weight:700; margin-bottom:8px">No active workout</div>
            <div class="muted" style="margin-bottom:12px">Start a plan from the Exercise Library to begin tracking sets, weights and reps.</div>
            <button class="btn" id="gotoLibraryBtn">
              <svg viewBox="0 0 24 24" fill="currentColor"><path d="M13 7l-1.41 1.41L14.17 11H4v2h10.17l-2.58 2.59L13 17l5-5z"/></svg>
              <span class="btn-text">Go to Library</span>
            </button>
          </div>
        </div>
      </div>
      <div class="sticky-actions" id="workoutActions" style="display:none">
        <div id="workoutTimer" class="muted">00:00</div>
        <div class="action-buttons">
          <button class="btn secondary" id="discardWorkoutBtn" title="Discard current workout">
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M6 19a2 2 0 002 2h8a2 2 0 002-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
            <span class="btn-text">Discard</span>
          </button>
          <button class="btn success" id="finishWorkoutBtn">
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.2l-3.5-3.5-1.4 1.4L9 19 20.3 7.7l-1.4-1.4z"/></svg>
            <span class="btn-text">Finish Workout</span>
          </button>
        </div>
      </div>
    </section>

    <!-- Calendar -->
    <section class="panel" id="panel-calendar" role="tabpanel" aria-labelledby="tab-calendar">
      <div class="calendar-head">
        <div style="display:flex; align-items:center; gap:8px">
          <button class="icon-btn" id="prevMonthBtn" aria-label="Previous month" title="Previous month">
            <svg viewBox="0 0 24 24" width="16" height="16" fill="#cbd5e1"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
          </button>
          <div id="monthLabel" style="font-weight:700; letter-spacing:.3px">Month YYYY</div>
          <button class="icon-btn" id="nextMonthBtn" aria-label="Next month" title="Next month">
            <svg viewBox="0 0 24 24" width="16" height="16" fill="#cbd5e1"><path d="M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"/></svg>
          </button>
        </div>
        <div style="display:flex; gap:8px">
          <button class="btn secondary" id="todayBtn">
            <span class="btn-text">Today</span>
          </button>
        </div>
      </div>
      <div class="calendar-grid" id="dowRow" aria-hidden="true" style="margin-top:10px">
        <div class="dow">Sun</div><div class="dow">Mon</div><div class="dow">Tue</div><div class="dow">Wed</div><div class="dow">Thu</div><div class="dow">Fri</div><div class="dow">Sat</div>
      </div>
      <div class="calendar-grid" id="calendarGrid" aria-live="polite"></div>

      <div class="details" id="dayDetails" hidden>
        <div style="display:flex; align-items:center; justify-content:space-between; gap:10px">
          <div id="detailsTitle" style="font-weight:700; letter-spacing:.3px">Date</div>
          <div id="detailsSummary" class="muted">0 workouts</div>
        </div>
        <div id="detailsList"></div>
      </div>
    </section>
  </div>

  <div id="userModal" class="modal" style="display:none">
    <div class="modal-content">
      <h3>User Options</h3>
      <div id="apiKeyMessage" style="display:none; color: var(--warning); font-size:14px; margin-bottom:8px">
        Please set your Gemini API key. Get one from <a href="https://aistudio.google.com/app/apikey" target="_blank" style="color: var(--accent)">Google AI Studio</a>.
      </div>
      <div style="margin-bottom:16px">
        <label for="apiKeyInput" style="display:block; margin-bottom:4px">Gemini API Key:</label>
        <input type="password" id="apiKeyInput" class="input-field" placeholder="Enter your API key">
      </div>
      <button id="saveApiKeyBtn" class="btn">Save API Key</button>
      <button id="logoutBtn" class="btn">Logout</button>
      <button id="backBtn" class="btn secondary">Back</button>
    </div>
  </div>

  <div id="incompleteModal" class="modal" style="display:none">
    <div class="modal-content">
      <h3>Finish Workout?</h3>
      <p>You have incomplete sets. What would you like to do?</p>
      <button id="continueWorkoutBtn" class="btn secondary">Continue Workout</button>
      <button id="removeIncompleteBtn" class="btn">Remove Incomplete Sets & Finish</button>
    </div>
  </div>

  <div id="generateModal" class="modal" style="display:none">
    <div class="modal-content">
      <h3>Generate Custom Workout</h3>
      <div style="margin-bottom:16px">
        <label for="workoutDescription" style="display:block; margin-bottom:4px">Describe your workout:</label>
        <textarea id="workoutDescription" class="input-field" placeholder="e.g., Upper body strength workout for beginners" rows="4"></textarea>
      </div>
      <button id="generateBtn" class="btn">Generate</button>
      <button id="cancelGenerateBtn" class="btn secondary">Cancel</button>
    </div>
  </div>

  <div id="exerciseSelectorModal" class="modal" style="display:none">
    <div class="modal-content" style="max-width:600px">
      <h3>Add Exercises to Workout</h3>
      <div class="filters" style="margin-bottom:16px">
        <div class="filter-chips">
          <div id="exerciseChips" class="chips">
            <span class="chip active" data-muscle="All">All</span>
            <span class="chip" data-muscle="Chest">Chest</span>
            <span class="chip" data-muscle="Back">Back</span>
            <span class="chip" data-muscle="Shoulders">Shoulders</span>
            <span class="chip" data-muscle="Arms">Arms</span>
            <span class="chip" data-muscle="Legs">Legs</span>
            <span class="chip" data-muscle="Core">Core</span>
            <span class="chip" data-muscle="Bodyweight">Bodyweight</span>
            <span class="chip" data-muscle="Cardio">Cardio</span>
            <span class="chip" data-muscle="Full Body">Full Body</span>
          </div>
        </div>
        <label class="search" title="Search exercises">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="#94a3b8" aria-hidden="true"><path d="M21 20l-5.7-5.7a7 7 0 10-1.4 1.4L20 21l1-1zM5 10a5 5 0 1110 0 5 5 0 01-10 0z"/></svg>
          <input id="exerciseSearchInput" type="search" placeholder="Search exercises..." aria-label="Search exercises" />
        </label>
      </div>
      <div id="exerciseSelectorGrid" class="grid" style="max-height:400px; overflow-y:auto; margin-bottom:16px"></div>
      <div style="display:flex; gap:8px; justify-content:flex-end">
        <button id="addSelectedExercisesBtn" class="btn">Add Selected</button>
        <button id="cancelExerciseSelectorBtn" class="btn secondary">Cancel</button>
      </div>
    </div>
  </div>

  <div id="floatingResume" class="floating-resume" style="display:none">
    <button class="btn">
      <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 3a9 9 0 100 18 9 9 0 000-18Zm-1 5.5a1 1 0 012 0v5.586l3.293-3.293a1 1 0 111.414 1.414l-5 5a.997.997 0 01-1.414 0l-5-5A1 1 0 117.707 10.8L11 14.086V8.5Z"/></svg>
      Resume workout
    </button>
  </div>

  <div id="floatingGenerate" class="floating-generate" style="display:none">
    <button class="btn" title="Generate Custom Workout">
      <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
    </button>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <!-- Firebase Config -->
  <script src="js/config.js"></script>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>

  <!-- Google Gen AI SDK -->
  <script type="module" src="https://esm.run/@google/genai"></script>

  <script src="js/workoutData.js"></script>
  <script type="module" src="js/script.js"></script>
</body>
</html>